<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文学灵魂伴侣匹配测试</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #2c1810; --accent: #d4a574; --bg: #f8f4ed; }
        body { background: var(--bg); color: var(--primary); font-family: "Noto Serif SC", serif; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .container { max-width: 600px; width: 90%; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); text-align: center; }
        .hidden { display: none !important; } /* 强制隐藏 */
        .btn { background: var(--primary); color: white; border: none; padding: 15px 40px; border-radius: 4px; cursor: pointer; font-size: 1.1rem; transition: 0.3s; margin-top: 20px; }
        .btn:hover { background: var(--accent); }
        .option-btn { display: block; width: 100%; padding: 15px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; background: none; cursor: pointer; text-align: left; transition: 0.2s; }
        .option-btn:hover { border-color: var(--accent); background: #fdfaf5; }
        .progress-bar { height: 4px; background: #eee; margin-bottom: 20px; border-radius: 2px; }
        .progress-fill { height: 100%; background: var(--accent); width: 0%; transition: 0.3s; }
    </style>
</head>
<body>

<div class="container" id="app">
    <div id="home-view">
        <h1 style="font-size: 2rem; margin-bottom: 10px;">寻找你的文学灵魂伴侣</h1>
        <p style="color: #666; margin-bottom: 30px;">通过 14 道测试题，在 60 位中外作家中<br>遇见那个最懂你的人。</p>
        <button class="btn" onclick="startTest()">开始测试 →</button>
    </div>

    <div id="test-view" class="hidden">
        <div class="progress-bar"><div id="progress" class="progress-fill"></div></div>
        <div id="step-indicator" style="font-size: 0.8rem; color: #999; margin-bottom: 10px;"></div>
        <h2 id="question-text" style="font-size: 1.3rem; margin-bottom: 25px;"></h2>
        <div id="options-box"></div>
    </div>

    <div id="result-view" class="hidden">
        <p style="letter-spacing: 2px; color: #999; font-size: 0.8rem;">匹配结果</p>
        <h1 id="match-name" style="font-size: 2.5rem; color: var(--primary); margin: 10px 0;"></h1>
        <div style="width: 40px; height: 3px; background: var(--accent); margin: 20px auto;"></div>
        <p id="match-bio" style="font-weight: bold;"></p>
        <p id="match-feature" style="text-align: left; font-size: 0.95rem; line-height: 1.8; color: #444; background: #f9f9f9; padding: 20px; border-radius: 8px;"></p>
        <div id="match-books" style="margin-top: 20px; text-align: left;"></div>
        <button class="btn" onclick="location.reload()">重新测试</button>
    </div>
</div>

<script>
// 这里放入我之前发给你的 writersData 名单（60人）
const writersData = [
    { name: "余华", bio: "现实残酷的代言人", feature: "以简洁有力的文字直击生存本质，不回避苦难，反而从中汲取力量。", books: ["《活着》"], scores: { style: 9, emotion: 10, theme: 9 } },
    { name: "卡夫卡", bio: "荒诞现代主义奠基人", feature: "你是这个世界的局外人吗？他最懂你无处安放的焦虑。", books: ["《变形记》"], scores: { style: 10, emotion: 6, theme: 10 } },
    // ... 请在这里继续粘贴之前补全的作家数据 ...
];

const questions = [
    { q: "如果你能拥有一张画，你希望它是？", options: [
        { t: "极简的黑白版画，只有冷冽的线条", s: { style: 10, theme: 5 } },
        { t: "色彩浓郁、人物繁多的油画", s: { style: 5, theme: 8 } }
    ]}
    // ... 请在这里继续粘贴之前补全的题目数据 ...
];

let currentStep = 0;
let userScores = { style: 0, emotion: 0, theme: 0 };

// 核心跳转函数：直接控制 display 属性
function startTest() {
    console.log("Button clicked!"); // 调试：如果没反应，看控制台
    document.getElementById('home-view').style.display = 'none';
    document.getElementById('test-view').classList.remove('hidden');
    showQuestion();
}

function showQuestion() {
    const q = questions[currentStep];
    document.getElementById('progress').style.width = ((currentStep / questions.length) * 100) + '%';
    document.getElementById('step-indicator').innerText = `${currentStep + 1} / ${questions.length}`;
    document.getElementById('question-text').innerText = q.q;
    const box = document.getElementById('options-box');
    box.innerHTML = '';
    q.options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.innerText = opt.t;
        btn.onclick = () => {
            for(let trait in opt.s) userScores[trait] = (userScores[trait] || 0) + opt.s[trait];
            currentStep++;
            if(currentStep < questions.length) showQuestion(); else showResult();
        };
        box.appendChild(btn);
    });
}

function showResult() {
    document.getElementById('test-view').style.display = 'none';
    document.getElementById('result-view').classList.remove('hidden');
    
    // 简易匹配逻辑
    let bestMatch = writersData[0];
    let maxScore = -1;
    writersData.forEach(w => {
        let currentMatchScore = 0;
        for(let s in userScores) {
            if(w.scores[s]) currentMatchScore += Math.abs(userScores[s] - w.scores[s]);
        }
        if(maxScore === -1 || currentMatchScore < maxScore) {
            maxScore = currentMatchScore;
            bestMatch = w;
        }
    });

    document.getElementById('match-name').innerText = bestMatch.name;
    document.getElementById('match-bio').innerText = bestMatch.bio;
    document.getElementById('match-feature').innerText = bestMatch.feature;
}
</script>
</body>
</html>
